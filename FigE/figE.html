<head>
	<script type="text/javascript" src = "maData.js"></script>
	<script type="text/javascript" src = "heatmapData.js"></script>
	<script type="text/javascript" src = "../src/linked-charts.min.js"></script>
  <link rel="stylesheet" type="text/css" href="../src/prism.css">
  <script type="text/javascript" src="../src/prism.js"></script>   
	<link rel="stylesheet" type="text/css" href="../src/linked-charts.css">
	<style>
		.fig-labels {
			position: absolute;
			left: 0px;
			top: 0px;
			font-weight: bold;
			font-size: 20pt;
			font-family: Verdana, Geneva, Tahoma, sans-serif;
			padding-top: 10px;
			padding-left: 10px;
		}
    p {
      font-family: sans-serif;
      text-align: center;
    }
	</style>
</head>
<body>

<div style="display: grid; grid-template-columns: repeat(4, 300px); grid-template-rows: 250px;" id="container">
  <div style="grid-column: 1; grid-row: 1;" class="linked-charts">
    <img src="pheatmap.png">
  </div>
  <div style="grid-column: 2; grid-row: 1;" class="linked-charts">
    <img src="scatter.png">
  </div>
  <div style="grid-column: 1/3; grid-row: 2">
    <pre class="language-r"><code>xSample <- 1
ySample <- 2
pheatmap(corMat)
plot(normCounts[, xSample], normCounts[, ySample], 
   cex = 0.5)
</code></pre>
  </div>
  <div style="grid-column: 1/5; grid-row: 3">
    <p style="margin-bottom: 0px; font-weight: bold;">To update the scatter plot:</p>
  </div>
  <div style="grid-column: 1/3; grid-row: 4">
    <p style="font-style: italic;">(repeat for any pair of saples)</p>
    <pre  class="language-r"><code>xSample <- 10
ySample <- 15

plot(normCounts[, xSample], normCounts[, ySample], 
   cex = 0.5)</code></pre>
  </div>
  <div style="grid-column: 3/5; grid-row: 2">
    <pre class="language-r"><code>xSample <- 1
ySample <- 2
lc_heatmap(value = corMat, clusterRows = TRUE, clusterCols = TRUE)
lc_scatter(x = normCounts[, xSample], y = normCounts[, ySample],
   size = 1.5)</code></pre>
  </div>
  <div style="grid-column: 3/5; grid-row: 4">
    <p  style="font-style: italic;">(add once to the heatmap arguments)</p>
    <pre class="language-r"><code>onClick = function(x, y) {
   xSample <<- x
   ySample <<- y
   updateCharts()
}</code></pre>
    
  </div>
</div>

<script type="text/javascript">
var xSample = 30, ySample = 31;

var hm = lc.heatmap()
  .nrows(hData.sampleNames.length)
  .ncols(hData.sampleNames.length)
  .value((i, j) => hData.corrMat[i][j])
  .rowLabel(i => hData.sampleNames[i])
  .colLabel(i => hData.sampleNames[i])
  .clusterRows(true)
  .clusterCols(true)
  .on_click(function(row, col) {
    xSample = row;
    ySample = col;
    sch.update();
  })
  .mode("svg")
  .place("#container");

hm.container
  .style("grid-column", "3")
  .style("grid-row", "1");

var sch = lc.scatter()
  .x(i => hData.countMatrix[i][xSample])
  .y(i => hData.countMatrix[i][ySample])
  .size(1.5)
  .mode("svg")
  .opacity(0.7)
  .place("#container");

sch.container
  .style("grid-column", "4")
  .style("grid-row", "1");

conts = d3.selectAll(".linked-charts")
	.data(["a)", "b)", "c)", "d)"])
		.append("div")
			.attr("class", "fig-labels")
			.text(d => d);

d3.selectAll(".linked-charts")
  .style("transform", "translate(-25%, -25%) scale(0.5)");
	</script>
</body>